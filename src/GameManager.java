package src;

import java.awt.BorderLayout;

import javax.swing.JFrame;
import javax.swing.JPanel;

/**
 * 界面控制器
 */
public class GameManager extends JFrame  {
 
   private JPanel panel;
   public GameManager frame;
   public boolean win;//关卡通过还是失败
	public int scores[] = {-1, -1, -1};//记录每个关卡的得分
   //关卡地图
   public int[][][] kinds = {{{0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0},
		  {0,4,4,0,4,4,0,4,0,4,4,0,4,0,4,4,0,4,4,0},
		  {0,4,4,0,4,4,0,4,0,4,4,0,4,0,4,4,0,4,4,0},
		  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		  {0,4,4,4,0,0,0,4,4,4,4,4,4,0,0,0,4,4,4,0},
		  {0,0,0,0,0,4,0,0,0,4,4,0,0,0,4,0,0,0,0,0},
		  {4,4,4,4,0,4,0,0,0,4,4,0,0,0,4,0,4,4,4,4},
		  {0,0,0,4,0,4,4,4,0,0,0,0,4,4,4,0,4,0,0,0},
		  {0,4,4,4,0,4,0,0,0,0,0,0,0,0,4,0,4,4,4,0},
		  {0,0,0,0,0,4,0,4,4,0,0,4,4,0,4,0,0,0,0,0},
		  {0,4,4,4,0,0,0,4,0,0,0,0,4,0,0,0,4,4,4,0},
		  {0,0,0,4,0,0,0,4,4,4,4,4,4,0,0,0,4,0,0,0},
		  {4,4,4,4,0,4,0,0,0,0,0,0,0,0,4,0,4,4,4,4},
		  {0,0,0,0,0,4,0,4,4,4,4,4,4,0,4,0,0,0,0,0},
		  {0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0},
		  {0,4,4,4,0,0,0,4,4,4,4,4,4,0,0,0,4,4,4,0},
		  {0,4,4,4,4,0,0,0,0,0,0,0,0,0,0,4,4,4,4,0},
		  {0,0,4,4,4,4,0,0,0,4,4,0,0,0,4,4,4,4,0,0},
		  {4,0,0,0,4,4,0,0,4,4,4,4,0,0,4,4,4,0,0,4},
		  {4,4,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,4,4}},
		   
		   {{4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0},
				{4,0,0,4,4,4,4,0,0,4,4,4,4,0,0,4,0,4,4,0},
				{4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,0,0},
				{4,4,4,4,0,0,4,4,4,4,0,0,4,4,0,4,0,4,4,4},
				{4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,4,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0},
				{4,4,4,4,4,0,4,4,4,4,4,4,4,4,4,4,0,4,0,0},
				{4,0,0,0,4,0,4,4,0,0,0,0,4,0,0,0,0,4,0,4},
				{4,0,4,0,4,0,4,4,0,4,4,0,4,0,4,4,0,4,0,0},
				{4,0,4,0,4,0,4,4,0,4,4,0,4,0,4,4,0,4,4,0},
				{4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0},
				{4,0,4,0,4,0,4,4,4,4,4,4,4,4,4,4,4,4,0,4},
				{4,0,4,0,4,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0},
				{4,0,0,0,4,0,4,4,0,4,4,0,4,0,4,0,0,4,4,0},
				{4,4,4,4,4,0,4,4,0,4,4,0,4,0,4,4,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,0,0,4,4,4},
				{0,4,4,4,4,4,4,4,4,4,4,4,4,0,4,0,4,4,4,4},
				{0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,4,0,0,0},
				{0,4,4,0,0,4,4,0,0,4,4,0,0,4,4,0,4,4,4,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}},
		   
		   {{4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4},
	    			  {4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4},
	    			  {4,4,0,0,4,4,4,4,0,4,4,0,4,4,4,4,0,0,0,0},
	    			  {4,4,4,0,4,4,4,4,0,4,4,0,4,4,4,4,0,4,4,4},
	    			  {4,4,4,0,0,0,4,4,0,4,4,0,0,0,0,0,0,0,0,0},
	    			  {4,0,0,0,0,0,4,4,0,4,4,0,4,4,4,4,4,4,4,0},
	    			  {4,4,4,4,0,0,4,4,0,4,4,0,4,0,0,0,4,0,0,0},
	    			  {4,4,4,4,0,0,0,0,0,0,0,0,4,0,4,0,0,0,4,0},
	    			  {0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4},
	    			  {4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4},
	    			  {4,4,4,4,0,4,4,0,0,0,0,0,0,0,0,4,4,0,4,4},
	    			  {0,0,4,0,0,4,4,0,0,0,0,0,0,0,0,4,4,0,4,4},
	    			  {4,0,4,0,0,4,4,4,4,4,4,4,4,4,0,4,4,0,0,4},
	    			  {0,0,4,0,0,4,4,4,4,4,4,4,4,4,0,4,4,0,4,4},
	    			  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4},
	    			  {4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0},
	    			  {4,4,4,0,0,0,4,4,4,0,0,4,4,4,0,0,0,4,4,0},
	    			  {0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0},
	    			  {4,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,4},
	    			  {4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4}}
		   };
   
   public GameManager(int levelNum, boolean win,int[] scores) {
      super("Pac man");
      this.scores = scores;
      setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      this.win = win;
      if(levelNum == 1) {  //关卡1
    	  getContentPane().add(getPanel(1), BorderLayout.CENTER);
      }
      else if(levelNum == 2) {  //关卡2
    	  getContentPane().add(getPanel(2), BorderLayout.CENTER);
      } 
      else if(levelNum == 3) {   //关卡3
    	  getContentPane().add(getPanel(3), BorderLayout.CENTER);
      }
      else if(levelNum == 0) {   //失败
    	  getContentPane().add(getPanel(0), BorderLayout.CENTER);
      }
      else if(levelNum == 100) { //通关
    	  getContentPane().add(getPanel(100), BorderLayout.CENTER);
      }
      setVisible(true);
      setSize(435,465);
      setLocationRelativeTo(null);
   }

   //界面
	protected JPanel getPanel(int level) {
      if (panel == null) {
    	  if(win) { //通过关卡
    		  if(level == 100) { //通关
    			  panel = new WinPanel(scores);
    		  }
    		  else {
		    	  if(level == 1) {
			    	  int[][] kind = kinds[0];
			    	  panel = new LevelPanel(this, kind, 1, scores);
		    	  }
		    	  else if(level == 2) {
			    	  int[][] kind = kinds[1];
			    	  panel = new LevelPanel(this, kind, 2, scores);
		    	  }
		    	  else if(level == 3) {
			    	  int[][] kind = kinds[2];
			    	  panel = new LevelPanel(this, kind, 3, scores);
		    	  }
		    	  panel.addMouseListener((LevelPanel)panel);
		          panel.addMouseMotionListener((LevelPanel)panel);
		          this.addKeyListener((LevelPanel)panel);
    		  }
    	  }
    	  else { //未通过关卡
    		  panel = new LosePanel(this, level, scores);
    		  panel.addMouseListener((LosePanel)panel);
	          panel.addMouseMotionListener((LosePanel)panel);
    	  }
          
      }
      return panel;
   }
   
}

